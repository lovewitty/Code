#pragma once
#include "../ComAll/XAsm.hpp"

static PCHAR	XPSSDT[ ] = {
	("NtAcceptConnectPort"),
	("NtAccessCheck"),
	("NtAccessCheckAndAuditAlarm"),
	("NtAccessCheckByType"),
	("NtAccessCheckByTypeAndAuditAlarm"),
	("NtAccessCheckByTypeResultList"),
	("NtAccessCheckByTypeResultListAndAuditAlarm"),
	("NtAccessCheckByTypeResultListAndAuditAlarmByHandle"),
	("NtAddAtom"),
	("NtEnumerateBootEntries"),
	("NtAdjustGroupsToken"),
	("NtAdjustPrivilegesToken"),
	("NtAlertResumeThread"),
	("NtAlertThread"),
	("NtAllocateLocallyUniqueId"),
	("NtAllocateUserPhysicalPages"),
	("NtAllocateUuids"),
	("NtAllocateVirtualMemory"),
	("NtAreMappedFilesTheSame"),
	("NtAssignProcessToJobObject"),
	("NtCallbackReturn"),
	("NtModifyBootEntry"),
	("NtCancelIoFile"),
	("NtCancelTimer"),
	("NtClearEvent"),
	("NtClose"),
	("NtCloseObjectAuditAlarm"),
	("NtCompactKeys"),
	("NtCompareTokens"),
	("NtCompleteConnectPort"),
	("NtCompressKey"),
	("NtConnectPort"),
	("NtContinue"),
	("NtCreateDebugObject"),
	("NtCreateDirectoryObject"),
	("NtCreateEvent"),
	("NtCreateEventPair"),
	("NtCreateFile"),
	("NtCreateIoCompletion"),
	("NtCreateJobObject"),
	("NtCreateJobSet"),
	("NtCreateKey"),
	("NtCreateMailslotFile"),
	("NtCreateMutant"),
	("NtCreateNamedPipeFile"),
	("NtCreatePagingFile"),
	("NtCreatePort"),
	("NtCreateProcess"),
	("NtCreateProcessEx"),
	("NtCreateProfile"),
	("NtCreateSection"),
	("NtCreateSemaphore"),
	("NtCreateSymbolicLinkObject"),
	("NtCreateThread"),
	("NtCreateTimer"),
	("NtCreateToken"),
	("NtCreateWaitablePort"),
	("NtDebugActiveProcess"),
	("NtDebugContinue"),
	("NtDelayExecution"),
	("NtDeleteAtom"),
	("NtModifyBootEntry"),
	("NtDeleteFile"),
	("NtDeleteKey"),
	("NtDeleteObjectAuditAlarm"),
	("NtDeleteValueKey"),
	("NtDeviceIoControlFile"),
	("NtDisplayString"),
	("NtDuplicateObject"),
	("NtDuplicateToken"),
	("NtEnumerateBootEntries"),
	("NtEnumerateKey"),
	("NtEnumerateSystemEnvironmentValuesEx"),
	("NtEnumerateValueKey"),
	("NendSection"),
	("NtFilterToken"),
	("NtFindAtom"),
	("NtFlushBuffersFile"),
	("NtFlushInstructionCache"),
	("NtFlushKey"),
	("NtFlushVirtualMemory"),
	("NtFlushWriteBuffer"),
	("NtFreeUserPhysicalPages"),
	("NtFreeVirtualMemory"),
	("NtFsControlFile"),
	("NtGetConThread"),
	("NtGetDevicePowerState"),
	("NtGetPlugPlayEvent"),
	("NtGetWriteWatch"),
	("NtImpersonateAnonymousToken"),
	("NtImpersonateClientOfPort"),
	("NtImpersonateThread"),
	("NtInitializeRegistry"),
	("NtInitiatePowerAction"),
	("NtIsProcessInJob"),
	("NtIsSystemResumeAutomatic"),
	("NtListenPort"),
	("NtLoadDriver"),
	("NtLoadKey"),
	("NtLoadKey2"),
	("NtLockFile"),
	("NtLockProductActivationKeys"),
	("NtLockRegistryKey"),
	("NtLockVirtualMemory"),
	("NtMakePermanentObject"),
	("NtMakeTemporaryObject"),
	("NtMapUserPhysicalPages"),
	("NtMapUserPhysicalPagesScatter"),
	("NtMapViewOfSection"),
	("NtModifyBootEntry"),
	("NtNotifyChangeDirectoryFile"),
	("NtNotifyChangeKey"),
	("NtNotifyChangeMultipleKeys"),
	("NtOpenDirectoryObject"),
	("NtOpenEvent"),
	("NtOpenEventPair"),
	("NtOpenFile"),
	("NtOpenIoCompletion"),
	("NtOpenJobObject"),
	("NtOpenKey"),
	("NtOpenMutant"),
	("NtOpenObjectAuditAlarm"),
	("NtOpenProcess"),
	("NtOpenProcessToken"),
	("NtOpenProcessTokenEx"),
	("NtOpenSection"),
	("NtOpenSemaphore"),
	("NtOpenSymbolicLinkObject"),
	("NtOpenThread"),
	("NtOpenThreadToken"),
	("NtOpenThreadTokenEx"),
	("NtOpenTimer"),
	("NtPlugPlayContro("),
	("NtPowerInformation"),
	("NtPrivilegeCheck"),
	("NtPrivilegeObjectAuditAlarm"),
	("NtPrivilegedServiceAuditAlarm"),
	("NtProtectVirtualMemory"),
	("NtPulseEvent"),
	("NtQueryAttributesFile"),
	("NtEnumerateBootEntries"),
	("NtEnumerateBootEntries"),
	("NtQueryDebugFilterState"),
	("NtQueryDefaultLocale"),
	("NtQueryDefaultUILanguage"),
	("NtQueryDirectoryFile"),
	("NtQueryDirectoryObject"),
	("NtQueryEaFile"),
	("NtQueryEvent"),
	("NtQueryFullAttributesFile"),
	("NtQueryInformationAtom"),
	("NtQueryInformationFile"),
	("NtQueryInformationJobObject"),
	("NtQueryInformationPort"),
	("NtQueryInformationProcess"),
	("NtQueryInformationThread"),
	("NtQueryInformationToken"),
	("NtQueryInstallUILanguage"),
	("NtQueryIntervalProfile"),
	("NtQueryIoCompletion"),
	("NtQueryKey"),
	("NtQueryMultipleValueKey"),
	("NtQueryMutant"),
	("NtQueryObject"),
	("NtQueryOpenSubKeys"),
	("NtQueryPerformanceCounter"),
	("NtQueryQuotaInformationFile"),
	("NtQuerySection"),
	("NtQuerySecurityObject"),
	("NtQuerySemaphore"),
	("NtQuerySymbolicLinkObject"),
	("NtQuerySystemEnvironmentValue"),
	("NtQuerySystemEnvironmentValueEx"),
	("NtQuerySystemInformation"),
	("NtQuerySystemTime"),
	("NtQueryTimer"),
	("NtQueryTimerResolution"),
	("NtQueryValueKey"),
	("NtQueryVirtualMemory"),
	("NtQueryVolumeInformationFile"),
	("NtQueueApcThread"),
	("NtRaiseException"),
	("NtRaiseHardError"),
	("NtReadFile"),
	("NtReadFileScatter"),
	("NtReadRequestData"),
	("NtReadVirtualMemory"),
	("NtRegisterThreadTerminatePort"),
	("NtReleaseMutant"),
	("NtReleaseSemaphore"),
	("NtRemoveIoCompletion"),
	("NtRemoveProcessDebug"),
	("NtRenameKey"),
	("NtReplaceKey"),
	("NtReplyPort"),
	("NtReplyWaitReceivePort"),
	("NtReplyWaitReceivePortEx"),
	("NtReplyWaitReplyPort"),
	("NtRequestDeviceWakeup"),
	("NtRequestPort"),
	("NtRequestWaitReplyPort"),
	("NtRequestWakeupLatency"),
	("NtResetEvent"),
	("NtResetWriteWatch"),
	("NtRestoreKey"),
	("NtResumeProcess"),
	("NtResumeThread"),
	("NtSaveKey"),
	("NtSaveKeyEx"),
	("NtSaveMergedKeys"),
	("NtSecureConnectPort"),
	("NtEnumerateBootEntries"),
	("NtEnumerateBootEntries"),
	("NtSetConThread"),
	("NtSetDebugFilterState"),
	("NtSetDefaultHardErrorPort"),
	("NtSetDefaultLocale"),
	("NtSetDefaultUILanguage"),
	("NtSetEaFile"),
	("NtSetEvent"),
	("NtSetEventBoostPriority"),
	("NtSetHighEventPair"),
	("NtSetHighWaitLowEventPair"),
	("NtSetInformationDebugObject"),
	("NtSetInformationFile"),
	("NtSetInformationJobObject"),
	("NtSetInformationKey"),
	("NtSetInformationObject"),
	("NtSetInformationProcess"),
	("NtSetInformationThread"),
	("NtSetInformationToken"),
	("NtSetIntervalProfile"),
	("NtSetIoCompletion"),
	("NtSetLdtEntries"),
	("NtSetLowEventPair"),
	("NtSetLowWaitHighEventPair"),
	("NtSetQuotaInformationFile"),
	("NtSetSecurityObject"),
	("NtSetSystemEnvironmentValue"),
	("NtQuerySystemEnvironmentValueEx"),
	("NtSetSystemInformation"),
	("NtSetSystemPowerState"),
	("NtSetSystemTime"),
	("NtSetThreadExecutionState"),
	("NtSetTimer"),
	("NtSetTimerResolution"),
	("NtSetUuidSeed"),
	("NtSetValueKey"),
	("NtSetVolumeInformationFile"),
	("NtShutdownSystem"),
	("NtSignalAndWaitForSingleObject"),
	("NtStartProfile"),
	("NtStopProfile"),
	("NtSuspendProcess"),
	("NtSuspendThread"),
	("NtSystemDebugContro("),
	("NtTerminateJobObject"),
	("NtTerminateProcess"),
	("NtTerminateThread"),
	("NtTestAlert"),
	("NtTraceEvent"),
	("NtTranslateFilePath"),
	("NtUnloadDriver"),
	("NtUnloadKey"),
	("NtUnloadKeyEx"),
	("NtUnlockFile"),
	("NtUnlockVirtualMemory"),
	("NtUnmapViewOfSection"),
	("NtVdmContro("),
	("NtWaitForDebugEvent"),
	("NtWaitForMultipleObjects"),
	("NtWaitForSingleObject"),
	("NtWaitHighEventPair"),
	("NtWaitLowEventPair"),
	("NtWriteFile"),
	("NtWriteFileGather"),
	("NtWriteRequestData"),
	("NtWriteVirtualMemory"),
	("NtYieldExecution"),
	("NtCreateKeyedEvent"),
	("NtOpenKeyedEvent"),
	("NtReleaseKeyedEvent"),
	("NtWaitForKeyedEvent"),
	("NtQueryPortInformationProcess")
};
static PCHAR	WIN7SSDT[ ] = {
	"NtAcceptConnectPort",
	"NtAccessCheck",
	"NtAccessCheckAndAuditAlarm",
	"NtAccessCheckByType",
	"NtAccessCheckByTypeAndAuditAlarm",
	"NtAccessCheckByTypeResultList",
	"NtAccessCheckByTypeResultListAndAuditAlarm",
	"NtAccessCheckByTypeResultListAndAuditAlarmByHandle",
	"NtAddAtom",
	"NtAddBootEntry",
	"NtAddDriverEntry",
	"NtAdjustGroupsToken",
	"NtAdjustPrivilegesToken",
	"NtAlertResumeThread",
	"NtAlertThread",
	"NtAllocateLocallyUniqueId",
	"NtAllocateReserveObject",
	"NtAllocateUserPhysicalPages",
	"NtAllocateUuids",
	"NtAllocateVirtualMemory",
	"NtAlpcAcceptConnectPort",
	"NtAlpcCancelMessage",
	"NtAlpcConnectPort",
	"NtAlpcCreatePort",
	"NtAlpcCreatePortSection",
	"NtAlpcCreateResourceReserve",
	"NtAlpcCreateSectionView",
	"NtAlpcCreateSecurityContext",
	"NtAlpcDeletePortSection",
	"NtAlpcDeleteResourceReserve",
	"NtAlpcDeleteSectionView",
	"NtAlpcDeleteSecurityContext",
	"NtAlpcDisconnectPort",
	"NtAlpcImpersonateClientOfPort",
	"NtAlpcOpenSenderProcess",
	"NtAlpcOpenSenderThread",
	"NtAlpcQueryInformation",
	"NtAlpcQueryInformationMessage",
	"NtAlpcRevokeSecurityContext",
	"NtAlpcSendWaitReceivePort",
	"NtAlpcSetInformation",
	"NtApphelpCacheControl",
	"NtAreMappedFilesTheSame",
	"NtAssignProcessToJobObject",
	"NtCallbackReturn",
	"NtCancelIoFile",
	"NtCancelIoFileEx",
	"NtCancelSynchronousIoFile",
	"NtCancelTimer",
	"NtClearEvent",
	"NtClose",
	"NtCloseObjectAuditAlarm",
	"NtCommitComplete",
	"NtCommitEnlistment",
	"NtCommitTransaction",
	"NtCompactKeys",
	"NtCompareTokens",
	"NtCompleteConnectPort",
	"NtCompressKey",
	"NtConnectPort",
	"NtContinue",
	"NtCreateDebugObject",
	"NtCreateDirectoryObject",
	"NtCreateEnlistment",
	"NtCreateEvent",
	"NtCreateEventPair",
	"NtCreateFile",
	"NtCreateIoCompletion",
	"NtCreateJobObject",
	"NtCreateJobSet",
	"NtCreateKey",
	"NtCreateKeyedEvent",
	"NtCreateKeyTransacted",
	"NtCreateMailslotFile",
	"NtCreateMutant",
	"NtCreateNamedPipeFile",
	"NtCreatePagingFile",
	"NtCreatePort",
	"NtCreatePrivateNamespace",
	"NtCreateProcess",
	"NtCreateProcessEx",
	"NtCreateProfile",
	"NtCreateProfileEx",
	"NtCreateResourceManager",
	"NtCreateSection",
	"NtCreateSemaphore",
	"NtCreateSymbolicLinkObject",
	"NtCreateThread",
	"NtCreateThreadEx",
	"NtCreateTimer",
	"NtCreateToken",
	"NtCreateTransaction",
	"NtCreateTransactionManager",
	"NtCreateUserProcess",
	"NtCreateWaitablePort",
	"NtCreateWorkerFactory",
	"NtDebugActiveProcess",
	"NtDebugContinue",
	"NtDelayExecution",
	"NtDeleteAtom",
	"NtDeleteBootEntry",
	"NtDeleteDriverEntry",
	"NtDeleteFile",
	"NtDeleteKey",
	"NtDeleteObjectAuditAlarm",
	"NtDeletePrivateNamespace",
	"NtDeleteValueKey",
	"NtDeviceIoControlFile",
	"NtDisableLastKnownGood",
	"NtDisplayString",
	"NtDrawText",
	"NtDuplicateObject",
	"NtDuplicateToken",
	"NtEnableLastKnownGood",
	"NtEnumerateBootEntries",
	"NtEnumerateDriverEntries",
	"NtEnumerateKey",
	"NtEnumerateSystemEnvironmentValuesEx",
	"NtEnumerateTransactionObject",
	"NtEnumerateValueKey",
	"NtExtendSection",
	"NtFilterToken",
	"NtFindAtom",
	"NtFlushBuffersFile",
	"NtFlushInstallUILanguage",
	"NtFlushInstructionCache",
	"NtFlushKey",
	"NtFlushProcessWriteBuffers",
	"NtFlushVirtualMemory",
	"NtFlushWriteBuffer",
	"NtFreeUserPhysicalPages",
	"NtFreeVirtualMemory",
	"NtFreezeRegistry",
	"NtFreezeTransactions",
	"NtFsControlFile",
	"NtGetContextThread",
	"NtGetCurrentProcessorNumber",
	"NtGetDevicePowerState",
	"NtGetMUIRegistryInfo",
	"NtGetNextProcess",
	"NtGetNextThread",
	"NtGetNlsSectionPtr",
	"NtGetNotificationResourceManager",
	"NtGetPlugPlayEvent",
	"NtGetWriteWatch",
	"NtImpersonateAnonymousToken",
	"NtImpersonateClientOfPort",
	"NtImpersonateThread",
	"NtInitializeNlsFiles",
	"NtInitializeRegistry",
	"NtInitiatePowerAction",
	"NtIsProcessInJob",
	"NtIsSystemResumeAutomatic",
	"NtIsUILanguageComitted",
	"NtListenPort",
	"NtLoadDriver",
	"NtLoadKey",
	"NtLoadKey2",
	"NtLoadKeyEx",
	"NtLockFile",
	"NtLockProductActivationKeys",
	"NtLockRegistryKey",
	"NtLockVirtualMemory",
	"NtMakePermanentObject",
	"NtMakeTemporaryObject",
	"NtMapCMFModule",
	"NtMapUserPhysicalPages",
	"NtMapUserPhysicalPagesScatter",
	"NtMapViewOfSection",
	"NtModifyBootEntry",
	"NtModifyDriverEntry",
	"NtNotifyChangeDirectoryFile",
	"NtNotifyChangeKey",
	"NtNotifyChangeMultipleKeys",
	"NtNotifyChangeSession",
	"NtOpenDirectoryObject",
	"NtOpenEnlistment",
	"NtOpenEvent",
	"NtOpenEventPair",
	"NtOpenFile",
	"NtOpenIoCompletion",
	"NtOpenJobObject",
	"NtOpenKey",
	"NtOpenKeyEx",
	"NtOpenKeyedEvent",
	"NtOpenKeyTransacted",
	"NtOpenKeyTransactedEx",
	"NtOpenMutant",
	"NtOpenObjectAuditAlarm",
	"NtOpenPrivateNamespace",
	"NtOpenProcess",
	"NtOpenProcessToken",
	"NtOpenProcessTokenEx",
	"NtOpenResourceManager",
	"NtOpenSection",
	"NtOpenSemaphore",
	"NtOpenSession",
	"NtOpenSymbolicLinkObject",
	"NtOpenThread",
	"NtOpenThreadToken",
	"NtOpenThreadTokenEx",
	"NtOpenTimer",
	"NtOpenTransaction",
	"NtOpenTransactionManager",
	"NtPlugPlayControl",
	"NtPowerInformation",
	"NtPrepareComplete",
	"NtPrepareEnlistment",
	"NtPrePrepareComplete",
	"NtPrePrepareEnlistment",
	"NtPrivilegeCheck",
	"NtPrivilegedServiceAuditAlarm",
	"NtPrivilegeObjectAuditAlarm",
	"NtPropagationComplete",
	"NtPropagationFailed",
	"NtProtectVirtualMemory",
	"NtPulseEvent",
	"NtQueryAttributesFile",
	"NtQueryBootEntryOrder",
	"NtQueryBootOptions",
	"NtQueryDebugFilterState",
	"NtQueryDefaultLocale",
	"NtQueryDefaultUILanguage",
	"NtQueryDirectoryFile",
	"NtQueryDirectoryObject",
	"NtQueryDriverEntryOrder",
	"NtQueryEaFile",
	"NtQueryEvent",
	"NtQueryFullAttributesFile",
	"NtQueryInformationAtom",
	"NtQueryInformationEnlistment",
	"NtQueryInformationFile",
	"NtQueryInformationJobObject",
	"NtQueryInformationPort",
	"NtQueryInformationProcess",
	"NtQueryInformationResourceManager",
	"NtQueryInformationThread",
	"NtQueryInformationToken",
	"NtQueryInformationTransaction",
	"NtQueryInformationTransactionManager",
	"NtQueryInformationWorkerFactory",
	"NtQueryInstallUILanguage",
	"NtQueryIntervalProfile",
	"NtQueryIoCompletion",
	"NtQueryKey",
	"NtQueryLicenseValue",
	"NtQueryMultipleValueKey",
	"NtQueryMutant",
	"NtQueryObject",
	"NtQueryOpenSubKeys",
	"NtQueryOpenSubKeysEx",
	"NtQueryPerformanceCounter",
	"NtQueryPortInformationProcess",
	"NtQueryQuotaInformationFile",
	"NtQuerySection",
	"NtQuerySecurityAttributesToken",
	"NtQuerySecurityObject",
	"NtQuerySemaphore",
	"NtQuerySymbolicLinkObject",
	"NtQuerySystemEnvironmentValue",
	"NtQuerySystemEnvironmentValueEx",
	"NtQuerySystemInformation",
	"NtQuerySystemInformationEx",
	"NtQuerySystemTime",
	"NtQueryTimer",
	"NtQueryTimerResolution",
	"NtQueryValueKey",
	"NtQueryVirtualMemory",
	"NtQueryVolumeInformationFile",
	"NtQueueApcThread",
	"NtQueueApcThreadEx",
	"NtRaiseException",
	"NtRaiseHardError",
	"NtReadFile",
	"NtReadFileScatter",
	"NtReadOnlyEnlistment",
	"NtReadRequestData",
	"NtReadVirtualMemory",
	"NtRecoverEnlistment",
	"NtRecoverResourceManager",
	"NtRecoverTransactionManager",
	"NtRegisterProtocolAddressInformation",
	"NtRegisterThreadTerminatePort",
	"NtReleaseKeyedEvent",
	"NtReleaseMutant",
	"NtReleaseSemaphore",
	"NtReleaseWorkerFactoryWorker",
	"NtRemoveIoCompletion",
	"NtRemoveIoCompletionEx",
	"NtRemoveProcessDebug",
	"NtRenameKey",
	"NtRenameTransactionManager",
	"NtReplaceKey",
	"NtReplacePartitionUnit",
	"NtReplyPort",
	"NtReplyWaitReceivePort",
	"NtReplyWaitReceivePortEx",
	"NtReplyWaitReplyPort",
	"NtRequestPort",
	"NtRequestWaitReplyPort",
	"NtResetEvent",
	"NtResetWriteWatch",
	"NtRestoreKey",
	"NtResumeProcess",
	"NtResumeThread",
	"NtRollbackComplete",
	"NtRollbackEnlistment",
	"NtRollbackTransaction",
	"NtRollforwardTransactionManager",
	"NtSaveKey",
	"NtSaveKeyEx",
	"NtSaveMergedKeys",
	"NtSecureConnectPort",
	"NtSerializeBoot",
	"NtSetBootEntryOrder",
	"NtSetBootOptions",
	"NtSetContextThread",
	"NtSetDebugFilterState",
	"NtSetDefaultHardErrorPort",
	"NtSetDefaultLocale",
	"NtSetDefaultUILanguage",
	"NtSetDriverEntryOrder",
	"NtSetEaFile",
	"NtSetEvent",
	"NtSetEventBoostPriority",
	"NtSetHighEventPair",
	"NtSetHighWaitLowEventPair",
	"NtSetInformationDebugObject",
	"NtSetInformationEnlistment",
	"NtSetInformationFile",
	"NtSetInformationJobObject",
	"NtSetInformationKey",
	"NtSetInformationObject",
	"NtSetInformationProcess",
	"NtSetInformationResourceManager",
	"NtSetInformationThread",
	"NtSetInformationToken",
	"NtSetInformationTransaction",
	"NtSetInformationTransactionManager",
	"NtSetInformationWorkerFactory",
	"NtSetIntervalProfile",
	"NtSetIoCompletion",
	"NtSetIoCompletionEx",
	"NtSetLdtEntries",
	"NtSetLowEventPair",
	"NtSetLowWaitHighEventPair",
	"NtSetQuotaInformationFile",
	"NtSetSecurityObject",
	"NtSetSystemEnvironmentValue",
	"NtSetSystemEnvironmentValueEx",
	"NtSetSystemInformation",
	"NtSetSystemPowerState",
	"NtSetSystemTime",
	"NtSetThreadExecutionState",
	"NtSetTimer",
	"NtSetTimerEx",
	"NtSetTimerResolution",
	"NtSetUuidSeed",
	"NtSetValueKey",
	"NtSetVolumeInformationFile",
	"NtShutdownSystem",
	"NtShutdownWorkerFactory",
	"NtSignalAndWaitForSingleObject",
	"NtSinglePhaseReject",
	"NtStartProfile",
	"NtStopProfile",
	"NtSuspendProcess",
	"NtSuspendThread",
	"NtSystemDebugControl",
	"NtTerminateJobObject",
	"NtTerminateProcess",
	"NtTerminateThread",
	"NtTestAlert",
	"NtThawRegistry",
	"NtThawTransactions",
	"NtTraceControl",
	"NtTraceEvent",
	"NtTranslateFilePath",
	"NtUmsThreadYield",
	"NtUnloadDriver",
	"NtUnloadKey",
	"NtUnloadKey2",
	"NtUnloadKeyEx",
	"NtUnlockFile",
	"NtUnlockVirtualMemory",
	"NtUnmapViewOfSection",
	"NtVdmControl",
	"NtWaitForDebugEvent",
	"NtWaitForKeyedEvent",
	"NtWaitForMultipleObjects",
	"NtWaitForMultipleObjects32",
	"NtWaitForSingleObject",
	"NtWaitForWorkViaWorkerFactory",
	"NtWaitHighEventPair",
	"NtWaitLowEventPair",
	"NtWorkerFactoryWorkerReady",
	"NtWriteFile",
	"NtWriteFileGather",
	"NtWriteRequestData",
	"NtWriteVirtualMemory",
	"NtYieldExecution"
};

static DWORD dwEAX,dwESP,dwIn;
extern bool HookFastCall(DWORD dwEAX,DWORD dwESP,DWORD dwIn);


static void WINAPI FF()
{

	HookFastCall(dwEAX,dwESP,dwIn);
}
static __declspec(naked) void NTAPI MyFastCall()
{

	if (0 == dwIn)
	{
		__asm
		{
			mov dwEAX,eax
			mov dwESP,esp
			pushad
			pushfd
			mov dwIn,1
			call FF
			mov dwIn,0
			popfd
			popad
		}
	}
	__asm
	{
		mov     edx, esp
		_emit 0x0f
		_emit 0x34

	}
}

//7C92D0AE >  B8 25000000     mov     eax, 0x25
//7C92D0B3    BA 0003FE7F     mov     edx, 0x7FFE0300
//7C92D0B8    FF12            call    dword ptr [edx]
//7C92D0BA    C2 2C00         retn    0x2C
//
//
//7C92E510 >  8BD4            mov     edx, esp
//7C92E512    0F34            sysenter
//7C92E514 >  C3              retn
static void InitHookFast()
{
	DWORD old;
	DWORD KFAddr = (DWORD)GetProcAddress(LoadLibraryA("ntdll.dll"),"KiFastSystemCall");
	DWORD KFHookTo = KFAddr-10;
	VirtualProtect((LPVOID)KFHookTo,4096,PAGE_EXECUTE_READWRITE,&old);
	SetJmpTo((uint8*)KFHookTo,(uint8*)&MyFastCall,E_JMP);
	
	VirtualProtect((LPVOID)KFAddr,4096,PAGE_EXECUTE_READWRITE,&old);
	SetJmpTo((uint8*)KFAddr,(uint8*)(KFAddr-10),E_SHORT_JMP);
}